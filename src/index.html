<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Geomeasure</title>
  <base href="./">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" type="image/x-icon" href="./assets/icons/logo_gmcav2trans.png">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDCIFx6Kn8VCrxUKobW4cYZRfFHWYVp8lg&libraries=drawing,geometry,places"></script><!--AIzaSyADc07XW6LL4iKZs1_zeFVZZn-D0DIVQuA-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <script src="assets/JS/geoxml3.js" type="text/javascript"></script>
  <script src="https://rawgit.com/nodeca/pako/master/dist/pako.js" type="text/javascript"></script>
  <!-- <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-8856921767199279",
        google_ad_test:'on',
        enable_page_level_ads: true
      });
    </script> -->
  <!-- <script type="text/javascript" src="http://pagead2.googlesyndication.com/pagead/show_ads.js"></script> -->
  <!-- <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script> -->
  <!-- <script async src=//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script> -->
  <!-- <script async src=//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script> -->
  <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
</head>
<body>
  <app-root></app-root>
  <div class="modal fade bd-example-modal-sm" tabindex="-1" id="updatemodal" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-sm">
      <div class="modal-content">
        <h5 id="downh5">Dowloading Geomeasure Updates...Please wait while downloading updates.</h5>
        <div class="progress">
          <div class="progress-bar progress-bar-striped progress-bar-animated bg-success text-black" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"><label  id="pbar" class="text-black">Downloading update <span id="upts"></span> %</label></div>
        </div>
      </div>
    </div>
  </div>
</body>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js"  crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/velocity/1.5.0/velocity.min.js"></script>
<script>
 
  
  // Listen for messages
  const {ipcRenderer} = require('electron');
  let upDateAvailable = false;
//  console.log(ipcRenderer);
  ipcRenderer.on('message', function(event, text) {
    
  //  console.log('text-------'+vX.Y.Z);
        console.log(text);
    //console.log('text-------'+vX.Y.Z);
    if(text=='Error'){
      upDateAvailable = false;
      console.log(event);
      console.log("Error");
      $("#updatemodal").modal('hide');

    }
    if(text=='update-available'){
      upDateAvailable = true;
      $("#updatemodal").modal({backdrop: 'static', keyboard: false,'show':true});

    }
    if(text==='update-not-available'){
      console.log("update-not-available");
      $("#updatemodal").modal('hide');
    }
    if(text=='update-downloaded'){
      $("#downh5").html("Installling Updates......");
      $('#pbar').html('installling.....');      

      setTimeout(function(){
          ipcRenderer.send('asynchronous-message', 'ping');
         $("#updatemodal").modal('hide');
        },30000);
  
    }
    if(text.indexOf('downloading----->') !== -1){
     
      var prg =  text.replace('downloading----->','');
      prg = parseFloat(prg);
      if(prg > 36){
        $('#pbar').addClass('text-white');       
      
      }
      $('.progress-bar').attr('aria-valuemin',prg);
      $('.progress-bar').css('width',prg+"%");
      $('#upts').html(Math.round(prg));
      if(prg == 100){
        $("#downh5").html("Installling Updates......");   
        $('#pbar').html('installling.....');         
    
      }
    }
    if(text==='Checking for update...'){
     console.log("checking for update");
    }
  });
  </script>
</html>
